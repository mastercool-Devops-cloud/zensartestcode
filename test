public String getObjectDDL(String schemaName, String objectName) {
    // Step 1: Identify the object type (TABLE or VIEW)
    String objectTypeQuery = """
        SELECT OBJECT_TYPE 
        FROM ALL_OBJECTS 
        WHERE OWNER = :schemaName 
          AND OBJECT_NAME = :objectName 
          AND OBJECT_TYPE IN ('TABLE', 'VIEW')
    """;

    MapSqlParameterSource params = new MapSqlParameterSource()
            .addValue("schemaName", schemaName.toUpperCase())
            .addValue("objectName", objectName.toUpperCase());

    String objectType = namedJdbcTemplate.queryForObject(objectTypeQuery, params, String.class);

    if (objectType == null) {
        throw new IllegalArgumentException("Object not found or not a TABLE/VIEW: " + objectName);
    }

    // Step 2: Set DBMS_METADATA options to exclude SCHEMA, TABLESPACE, STORAGE
    String configSql = """
        BEGIN
            DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM, 'SCHEMA', false);
            DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM, 'STORAGE', false);
            DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM, 'TABLESPACE', false);
            DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM, 'SEGMENT_ATTRIBUTES', false);
        END;
        """;
    namedJdbcTemplate.getJdbcTemplate().execute(configSql);

    // Step 3: Generate the correct DDL for the object
    String ddlQuery = "SELECT DBMS_METADATA.GET_DDL(:objectType, :objectName, :schemaName) FROM DUAL";

    params.addValue("objectType", objectType);

    String ddl = namedJdbcTemplate.queryForObject(ddlQuery, params, String.class);

    // Step 4: Remove schema name manually if still present (SCHEMA_NAME.TABLE_NAME â†’ TABLE_NAME)
    if (ddl != null) {
        ddl = ddl.replaceAll(schemaName.toUpperCase() + "\\.", ""); 
    }

    return ddl;
}
