public static Map<String, String> getRequestBodyAsMap(final HttpServletRequest request) {
    Map<String, String> requestBodyMap = new HashMap<>();

    Optional.ofNullable(request)
        .filter(req -> req instanceof CachedBodyHttpServletRequestWapper)
        .ifPresent(req -> {
            CachedBodyHttpServletRequestWapper wrappedRequest = (CachedBodyHttpServletRequestWapper) req;
            try {
                byte[] content = wrappedRequest.getInputStream().readAllBytes();
                String body = new String(content, StandardCharsets.UTF_8);

                // Assuming request body is JSON, convert it into a Map
                ObjectMapper objectMapper = new ObjectMapper();
                requestBodyMap.putAll(objectMapper.readValue(body, new TypeReference<Map<String, String>>() {}));
            } catch (IOException e) {
                throw new RuntimeException("Error reading request body", e);
            }
        });

    return requestBodyMap;
}
